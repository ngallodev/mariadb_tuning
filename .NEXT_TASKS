# Next Session Priority Tasks
# Read SESSION_HANDOFF.md for full context

## COMPLETED TASKS ✓

### Task 1: Enhance bulk_load.sh for Multiple File Formats - COMPLETED ✓
Status: DONE (2025-10-16)
File: bulk_load.sh (lines 18-133)

File format support was ALREADY IMPLEMENTED with full functionality:
- ✓ CSV format (--format=csv)
- ✓ TSV/Tab format (--format=tsv or --format=tab, default)
- ✓ Custom delimiters (--delimiter='|')
- ✓ Field enclosures (--enclosure='"')
- ✓ Header row skipping (--skip-header)
- ✓ Windows line endings (--line-terminator='\r\n')

Command-line flags implemented:
  --format=csv|tsv|tab|custom
  --delimiter='char'
  --enclosure='"'|"'"
  --skip-header
  --line-terminator='\n'|'\r\n'

### Task 2: Create Tests for File Format Features - COMPLETED ✓
Status: DONE (2025-10-16 by Claude)
Files: tests/unit/test_bulk_load.sh, tests/integration/test_full_workflow.sh

Condensed unit tests (10→3 tests):
- ✓ Argument validation
- ✓ Format option parsing (CSV, headers, delimiters)
- ✓ Script structure checks

Added integration tests (3 new tests):
- ✓ CSV format with header skip
- ✓ Custom pipe delimiter
- ✓ Tab-delimited default

All tests passing (6/6 unit, 25/28 integration)

### Task 3: Task Completion Log - COMPLETED ✓
The task_status.log file is active and being used.
Convention: Add "- Claude" or "- Codex" signature to identify who completed the task.

## FUTURE IMPROVEMENTS (Lower Priority)

### Add Trap Handlers to bulk_load.sh
Issue: Ctrl+C leaves server in extreme mode
Solution: Add trap handler to always restore conservative mode
Reference: codex.md, CLAUDE.md

### Add State Snapshotting
Issue: Scripts restore hard-coded values, not original settings
Solution: Capture actual values before changing them
Reference: codex.md lines 30-34

### Quote SQL Identifiers
Issue: SQL injection risk with database/table names
Solution: Use backticks around identifiers
Reference: codex.md line 14

### Fix mariadb_status.sh Hard-coded Credentials
Issue: Ignores MYSQL_OPTS parameter
Solution: Use MYSQL_CMD="mariadb $MYSQL_OPTS"
Reference: mariadb_status.sh:20, codex.md line 19

## VERIFICATION CHECKLIST

Before completing each task:
- [ ] Read SESSION_HANDOFF.md for context
- [ ] Run existing tests: ./tests/run_all_tests.sh
- [ ] Verify all tests still pass
- [ ] Create new tests for new functionality
- [ ] Update .task_log with completion timestamp
- [ ] Update this file if task details change

## QUICK REFERENCE

Working Directory: /usr/local/lib/mariadb
Test Command: cd tests && ./run_all_tests.sh
Documentation: cat SESSION_HANDOFF.md
Known Issues: cat codex.md
Task Log: tail -20 .task_log
